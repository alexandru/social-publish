@username = alex
@password = pass
@baseUrl = http://localhost:3000

###
# @name Login
POST {{baseUrl}}/api/login
Content-Type: application/x-www-form-urlencoded

username={{encodeURIComponent(username)}}&password={{encodeURIComponent(password)}}

{{
  $global.jwt=response.parsedBody.token;
}}

###
# @name Feed post
POST {{baseUrl}}/api/feed/post
Authorization: Bearer {{$global.jwt}}
Content-Type: application/json

{
  "targets": ["feed"],
  "language": "en",
  "messages": [
    {
      "content": "Hello from the feed API",
      "link": "https://example.com"
    }
  ]
}

###
# @name Broadcast thread (Bluesky + Mastodon + Twitter + Feed)
POST {{baseUrl}}/api/multiple/post
Authorization: Bearer {{$global.jwt}}
Content-Type: application/json

{
  "targets": ["bluesky", "mastodon", "twitter", "feed"],
  "language": "en",
  "messages": [
    { "content": "Thread root post" },
    { "content": "Thread reply #1" },
    { "content": "Thread reply #2", "link": "https://example.com/thread" }
  ]
}

###
# @name Broadcast LinkedIn with one follow-up comment
POST {{baseUrl}}/api/multiple/post
Authorization: Bearer {{$global.jwt}}
Content-Type: application/json

{
  "targets": ["linkedin", "feed"],
  "language": "en",
  "messages": [
    { "content": "LinkedIn root post" },
    { "content": "Link in comments: https://example.com" }
  ]
}

###
# @name Upload image
POST {{baseUrl}}/api/files/upload
Authorization: Bearer {{$global.jwt}}
Content-Type: multipart/form-data; boundary=WebKitFormBoundary

--WebKitFormBoundary
Content-Disposition: form-data; name="altText"

My cat
--WebKitFormBoundary
Content-Disposition: form-data; name="file"; filename="cat.jpeg"
Content-Type: image/jpeg

< ./docs/cat.jpeg
--WebKitFormBoundary--

{{
  $global.imageUuid=response.parsedBody.uuid;
}}

###
# @name Post with image in messages[0]
POST {{baseUrl}}/api/multiple/post
Authorization: Bearer {{$global.jwt}}
Content-Type: application/json

{
  "targets": ["bluesky", "mastodon", "twitter", "feed"],
  "messages": [
    {
      "content": "Picture post",
      "images": ["{{$global.imageUuid}}"]
    }
  ]
}
